<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Sherullah Il Moazzam 1444H</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <style>
        body {
            background: url('../background.jpg');
            background-repeat: no-repeat;
            background-attachment: fixed;
            background-size: 100% 100%;
        }

        input[type="submit"]:disabled {
            background: lightblue;
        }

        input[type="submit"]:enabled {
            background: blue;
        }

        .text {
            font-size: 20px;
            font-weight: bold;
            color: red;
            text-align: right;
        }

        .text2 {
            font-size: 30px;
            font-weight: bold;
            color: red;
            text-align: center;
        }

        .box {
            border-width: 3px solid;
            width: 1000px;
            height: 400px;
            border: double black;
            float: left;
        }

        .box1 {
            border-width: 3px solid;
            width: 400px;
            height: 100px;
            border: double black;
            float: right;
        }

        input.chkbox {
            width: 20px;
            height: 20px;

        }
    </style>



</head>

<body>

    {{!-- <nav class="navbar">

        <a class="nav nav-link" href="/admin/list">Raza List</a>
        <a class="nav nav-link" href="/update">Update</a>
        <a class="nav nav-link" href="/register">Register</a>
        <a class="nav nav-link text-decoration-none text-red" style="text-decoration:none;color:red" href="/logout">
            Sign out

        </a>
    </nav> --}}

    <header>
  <!-- Fixed navbar -->
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Sherullah il Moazzam 1444H</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav me-auto mb-2 mb-md-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/admin/list">Raza List</a>
          </li>
        <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/update">Update</a>
          </li>
        <li class="nav-item">
            <a class="nav-link active" aria-current="page"  href="/register">Register</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active text-danger" aria-current="page"  href="/admin/list"> Sign out</a>
          </li>
        
      </div>
    </div>
  </nav>
</header>


    <br><br>
    <div class="mt-5">
        <div class=" w-100">

            <center>
                <form class="form w-50" action="/admin/panel" method="post">
                    <label for="its id" class="form-label">ITS ID</label>
                    <textarea class="form-control" name="its" id="" cols="40" rows="10" class="form-control"
                        placeholder="paste All its here "></textarea>
                    <br>
                    <br>
                    <input type="submit" value="Submit" style="color:white;width:10vmax; height:50px;">
                </form>

                <div class="overflow-scroll">
                    <table class="table table-responsive table-striped overfow-auto" border="1px">

                        <tr>
                            <th>
                                ITS id
                            </th>
                            <th>
                                Name
                            </th>
                            <th>
                                Mobile
                            </th>
                            <th>Misaq</th>
                            <th>Age</th>
                            <th>
                                Select Event
                            </th>
                            <th>
                                Previous Details
                            </th>
                            <th>
                                Action
                            </th>


                        </tr>


                        {{#each message}}
                        <tr>

                            <td>{{this.its_id}}</td>
                            <td>{{this.name}}</td>
                            <td>{{this.mobile}}</td>
                            <td>{{this.misaq}}</td>
                            <td>{{this.age}}</td>
                            <td>
                                <select name="event" id={{this.its_id}}>
                                    {{#each events}}
                                    <option value={{this.id}}>{{this.event}}</option>
                                    {{/each}}
                                </select>
                            </td>
                            <td class="d-flex p-2">
                                {{!-- <div class="alert alert-danger me-2 " >{{already}}</div> --}}
                                <div class="dropdown ms-2">
                                    <button class="btn btn-secondary dropdown-toggle"
                                    onclick="toggle()"
                                     type="button"
                                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                       show details ({{already}} }
                                    </button>
                                    <div class="dropdown-menu" id="open" aria-labelledby="dropdownMenuButton">
                                        {{#each allocated}}
                                        <p class="dropdown-item" href="#">{{this.event}}</p>
                                        {{/each}}
                                       
                                    </div>
                                </div>
                            </td>
                            <td>
                                <button class="btn btn-success"
                                    onclick="fun({{this.its_id}},document.getElementById('{{this.its_id}}').value)">Save</button>
                            </td>

                        </tr>


                        {{/each}}

                    </table>

                </div>
            </center>


            {{!-- <select name="dates" id="dates">
                {{#each message}}
                {{this}}
                {{!-- <option value={{this}}>{{this}}</option>
                {{/each}}
            </select> --}}

        </div>
        
   <footer class="footer w-100 bg-dark flex-column justify-content-center w-100 align-items-center text-white fixed-bottom" style="display:flex;">
  
   <p>Powered by:-</p> <p>Toloba-ul-Kulliyat-ul-Mumeneen-Noorani Nagar</p>  
  
</footer>
        
 
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E="
    crossorigin="anonymous"></script>
<script>
   
    function fun(id, value) {
        $.ajax({
            type: "POST",
            url: "/allocate",
            dataType: "json",
            async: true,
            cache: false,
            data: {
                its_id: id,
                event_id: value
            },
            success: function (data, status) {
                if (data.success == false) {
                    alert(data.error);
                } else {
                    alert("Raza Allocated");

                    $("#print").show();
                }
            }
        })
        console.log(id, value);
    }
    function toggle(){
        $("#open").toggle();
    }

</script>


</html>